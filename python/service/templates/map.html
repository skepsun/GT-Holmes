<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="apple-touch-icon" sizes="76x76" href="{{ url_for('static', filename='img/apple-icon.png') }}" />
	<link rel="icon" type="image/png" href="{{ url_for('static', filename='img/favicon.png') }}" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>Crime Detection</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />


    <!-- Bootstrap core CSS     -->
    <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet" />

    <!--  Material Dashboard CSS    -->
    <link href="{{ url_for('static', filename='css/material-dashboard.css') }}" rel="stylesheet"/>

    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="{{ url_for('static', filename='css/demo.css') }}" rel="stylesheet" />

    <!--     Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300|Material+Icons' rel='stylesheet' type='text/css'>
</head>

<body>

	<div class="wrapper">
	    <div class="sidebar" data-color="red" data-image="{{ url_for('static', filename='img/sidebar-1.jpg') }}">
			<!--
		        Tip 1: You can change the color of the sidebar using: data-color="purple | blue | green | orange | red"

		        Tip 2: you can also add an image using data-image tag
		    -->

			<div class="logo">
				<a href="http://www.creative-tim.com" class="simple-text">
					Crime Detection Engine
				</a>
			</div>

	    	<div class="sidebar-wrapper">
				<ul class="nav">
					<li class="active">
	                    <a href="maps.html">
	                        <i class="material-icons">location_on</i>
	                        <p>Maps</p>
	                    </a>
	                </li>
	                <li>
	                    <a href="table.html">
	                        <i class="material-icons">content_paste</i>
	                        <p>Analysis</p>
	                    </a>
	                </li>
	                <li>
	                    <a href="typography.html">
	                        <i class="material-icons">library_books</i>
	                        <p>Records</p>
	                    </a>
	                </li>
	            </ul>
	    	</div>
		</div>

	    <div class="main-panel">
			<nav class="navbar navbar-transparent navbar-absolute">
				<div class="container-fluid">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle" data-toggle="collapse">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="#">Crime Maps</a>
					</div>
					<div class="collapse navbar-collapse">
						<ul class="nav navbar-nav navbar-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">
									<i class="material-icons">notifications</i>
									<span class="notification">5</span>
									<p class="hidden-lg hidden-md">Notifications</p>
								</a>
								<ul class="dropdown-menu">
									<li><a href="#">Mike John responded to your email</a></li>
									<li><a href="#">You have 5 new tasks</a></li>
									<li><a href="#">You're now friend with Andrew</a></li>
									<li><a href="#">Another Notification</a></li>
									<li><a href="#">Another One</a></li>
								</ul>
							</li>
						</ul>
					</div>
				</div>
			</nav>

			<div class="content" style="height:100%">
	            <div class="container-fluid" style="height:100%">
	                <div class="row" style="height:100%">
	                    <div class="col-md-4">
	                    	<div class="row" style="width:100%">
	                    		<div class="col-md-4" style="width:100%">
			                        <div class="card card-nav-tabs">
			                            <div class="card-header" data-background-color="purple">
											<div class="nav-tabs-navigation">
												<div class="nav-tabs-wrapper">
													<!-- <span class="nav-tabs-title">Tasks:</span> -->
													<ul class="nav nav-tabs" data-tabs="tabs">
														<li class="active">
															<a href="#search_id" data-toggle="tab">
																<i class="material-icons">vpn_key</i>
																Crime Id
															<div class="ripple-container"></div></a>
														</li>
														<li class="">
															<a href="#search_words" data-toggle="tab">
																<i class="material-icons">description</i>
																Key Word
															<div class="ripple-container"></div></a>
														</li>
													</ul>
												</div>
											</div>
										</div>
			                            <div class="tab-content">
											<div class="tab-pane active" id="search_id">
												<div class="card-content">
													<form>
														<div class="row">
					                                        <div class="col-md-6">
																<div class="form-group label-floating">
																	<label class="control-label">Crime Id</label>
																	<input id="crime_id_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                        <div class="col-md-6">
																<div class="form-group label-floating">
																	<label class="control-label">Threshold</label>
																	<input id="si_threshold_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                    </div>
					                                    <div class="row">
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">From Year</label>
																	<input id="si_from_year_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">From Month</label>
																	<input id="si_from_month_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">From Day</label>
																	<input id="si_from_day_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                    </div>
					                                    <div class="row">
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">To Year</label>
																	<input id="si_to_year_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">To Month</label>
																	<input id="si_to_month_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">To Day</label>
																	<input id="si_to_day_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                    </div>
													</form>
													<button id="search_id_btn" class="btn btn-primary pull-right">Search</button>
	                                    			<div class="clearfix"></div>
												</div>
											</div>
											<div class="tab-pane" id="search_words">
												<div class="card-content">
													<form>
														<div class="row">
					                                        <div class="col-md-6">
																<div class="form-group label-floating">
																	<label class="control-label">Key Words</label>
																	<input id="key_words_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                        <div class="col-md-6">
																<div class="form-group label-floating">
																	<label class="control-label">Threshold</label>
																	<input id="sw_threshold_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                    </div>
					                                    <div class="row">
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">From Year</label>
																	<input id="sw_from_year_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">From Month</label>
																	<input id="sw_from_month_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">From Day</label>
																	<input id="sw_from_day_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                    </div>
					                                    <div class="row">
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">To Year</label>
																	<input id="sw_to_year_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">To Month</label>
																	<input id="sw_to_month_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                        <div class="col-md-4">
																<div class="form-group label-floating">
																	<label class="control-label">To Day</label>
																	<input id="sw_to_day_input" type="text" class="form-control" >
																</div>
					                                        </div>
					                                    </div>
					                                    <div class="row">
					                                    	<table class="table">
																<tbody>
																	<tr>
																		<td>
																			<div class="checkbox">
																				<label>
																					<input type="checkbox" name="optionsCheckboxes" checked>
																				</label>
																			</div>
																		</td>
																		<td>Enable to search similar words?</td>
																	</tr>
																</tbody>
															</table>
					                                    </div>
													</form>
													<button id="search_words_btn" class="btn btn-primary pull-right">Search</button>
					                                <div class="clearfix"></div>
												</div>
											</div>
										</div>
			                        </div>
			                    </div>
	                    	</div>
	                    	<!-- <div class="row" style="width:100%">
	                    		<div class="col-md-4" style="width:100%">
	                    			<div class="card" style="width:100%">
	                    				<div class="card-header" data-background-color="purple">
			                                <h4 class="title">Map Configuration</h4>
											<p class="category">Complete your profile</p>
			                            </div>
			                            <div class="card-content" id="test_legend">
			                            </div>
	                    			</div>
	                    		</div>
	                    	</div> -->
	                    </div>
						<div class="col-md-8" style="height:100%">
    						<div class="card" style="height:100%">
	                            <div class="card-content" style="height:100%">
	                                <div id="map"></div>
	                            </div>
	                        </div>
		    			</div>
	                </div>
	            </div>
	        </div>

	    </div>
	</div>

</body>

	<!-- Core JS Files   -->
	<script src="{{ url_for('static', filename='js/jquery-3.1.0.min.js') }}" type="text/javascript"></script>
	<script src="{{ url_for('static', filename='js/bootstrap.min.js') }}" type="text/javascript"></script>
	<script src="{{ url_for('static', filename='js/material.min.js') }}" type="text/javascript"></script>
	<script src="{{ url_for('static', filename='js/underscore.js') }}" type="text/javascript"></script>
	<script src="https://d3js.org/d3.v4.min.js"></script>

	<!-- Notifications Plugin -->
	<script src="{{ url_for('static', filename='js/bootstrap-notify.js') }}"></script>

	<!-- Main JS code -->
	<script src="{{ url_for('static', filename='js/maps.js') }}"></script>

	<!-- Google Maps Plugin -->
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD4g1uo-ONEqqnTYMWFww-7Rxbqgve6nsA" type="text/javascript"></script>

	<!-- Material Dashboard javascript methods -->
	<script src="{{ url_for('static', filename='js/material-dashboard.js') }}"></script>
	<script src="{{ url_for('static', filename='js/utils.js') }}"></script>

    <script>
    	maps.initGoogleMaps("map");
    	// Configuration of colorbar
    	var colorbarLength = 1000,
    		colorbar = d3.scaleLinear().domain([1,colorbarLength])
			.interpolate(d3.interpolateHcl)
			.range([d3.rgb("#007AFF"), d3.rgb("#FFF500")]);
		
		// Get dom elements by their Ids
		var searchIdBtn    = document.getElementById("search_id_btn"),
			searchWordsBtn = document.getElementById("search_words_btn");

		var queryMarkers = null;

		// Onclick event for search Id button
		searchIdBtn.onclick = function () {
			var crimeId   = document.getElementById("crime_id_input").value,
				threshold = document.getElementById("si_threshold_input").value,
				fromYear  = document.getElementById("si_from_year_input").value,
				fromMonth = document.getElementById("si_from_month_input").value,
				fromDay   = document.getElementById("si_from_day_input").value,
				toYear    = document.getElementById("si_to_year_input").value,
				toMonth   = document.getElementById("si_to_month_input").value,
				toDay     = document.getElementById("si_to_day_input").value;

			var startTime = new Date(fromYear, fromMonth, fromDay, 0, 0, 0, 0),
				endTime   = new Date(toYear, toMonth, toDay, 0, 0, 0, 0);

			var para = {
				startTime: startTime.getTime(),
				endTime: endTime.getTime(),
				crimeId: crimeId,
				threshold: threshold
			};

			requestBackEnd(para, "/searchCrimeId").then(function (simPoints) {
				// Remove the current result on the map
				if (queryMarkers != null) {
					maps.clearMarkers(queryMarkers);
					queryMarkers = null;
				}
				// Prepare the points which be painted on the map
				var colorPoints = _.map(simPoints, function (point) {
					return {
						position: point["position"],
						color: colorbar(Math.ceil(point["similarity"] * colorbarLength)),
						weight: point["similarity"] * 20
					}
				});
				// Place the marker on the map
				queryMarkers = maps.createMarkers(colorPoints);
			});
		};

		// Onclick event for search keywords button
		searchWordsBtn.onclick = function () {
			var keywords  = document.getElementById("key_words_input").value,
				threshold = document.getElementById("sw_threshold_input").value,
				fromYear  = document.getElementById("sw_from_year_input").value,
				fromMonth = document.getElementById("sw_from_month_input").value,
				fromDay   = document.getElementById("sw_from_day_input").value,
				toYear    = document.getElementById("sw_to_year_input").value,
				toMonth   = document.getElementById("sw_to_month_input").value,
				toDay     = document.getElementById("sw_to_day_input").value;

			var startTime = new Date(fromYear, fromMonth, fromDay, 0, 0, 0, 0),
				endTime   = new Date(toYear, toMonth, toDay, 0, 0, 0, 0);

			// requestBackEnd().then(function () {
				
			// });
		};



    </script>

</html>
